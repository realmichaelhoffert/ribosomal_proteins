# ribosomal_proteins

This is the first draft of the code.

### Making bacterial ribosomal protein annotations more accessible
A pipeline based on the RefSeq Prokaryotic Genome Annotation Pipeline (PGAP), designed to rapidly annotate the presence of ribosomal proteins in bacterial genomes. This project was motivated by the fact that [gRodon](https://github.com/jlw-ecoevo/gRodon) uses RefSeq PGAP annotations of ribosomal proteins, but PGAP can take up to 6 hours to run for moderately sized genomes. Ribosomal protein annotations generated by this pipeline and used in gRodon currently achieve a correlation of 0.91 with EGGO estimated growth rates, taking approximately 25 seconds to completely annotate the ribosomal proteins in each genome.


## Constructing ribosomal protein reference databases
The PGAP has 3 references databases, each with entries of different precedence. The reference databases and their entries are described here:
https://www.ncbi.nlm.nih.gov/genome/annotation_prok/evidence/. The 3 databases are: CDD, the PGAP HMMs, and the PGAP BlastRules. To make a faster version of this pipeline, I am subsetting each database to only the entries relevant to ribosomal proteins.

### CDD (for use with SPARCLE)

Get the cddid table (Accessed on May 26, 2022)
```
wget https://ftp.ncbi.nih.gov/pub/mmdb/cdd/cddid.tbl.gz
```
Get the cdd data
```
wget cdd.tar.gz
tar -xzf cdd.tar.gz
mkdir smp
mv *.smp smp
```
The \*.smp files are Position Specific Substitution Matrices. The \*.pn files list filenames of \*.smp files which should be used to make a RPSBlast database.
  
  To make a ribosomal-protein specific RPSBlast database, I subset the .smp files to only those which I determined were ribosomal proteins.
Compile the blast database:
```
~/tools/SparcleLabel/SparcleLabel-x64-linux/ncbi-blast-2.13.0+/bin/makeprofiledb -title ribosomal_proteins -in ribosomal_proteins.pn -out ribosomal_proteins -threshold 9.92 -scale 100.0 -dbtype rps -index true
```
### HMMs
```
wget https://ftp.ncbi.nih.gov/hmm/current/hmm_PGAP.HMM.tgz
tar -xzvf hmm_PGAP.HMM.tgz
wget https://ftp.ncbi.nih.gov/hmm/current/hmm_PGAP.tsv
[ code to subset hmms]
hmmpress ribosomal_hmm
```
### BlastRules
```
makeblastdb -in ribosomal_proteins.fasta -dbtype prot -out ribosomal_proteins
```

## Sparcle documentation
https://ftp.ncbi.nlm.nih.gov/pub/mmdb/cdd/SparcleLabel/README
## Database links
https://ftp.ncbi.nih.gov/pub/blastrules/RELEASE_4.0/
https://ftp.ncbi.nih.gov/hmm/current/
https://ftp.ncbi.nlm.nih.gov/pub/mmdb/cdd/SparcleLabel/README
https://ftp.ncbi.nih.gov/blast/executables/LATEST/
https://www.ncbi.nlm.nih.gov/genome/annotation_prok/evidence/
